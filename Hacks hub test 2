-- Hacks Hub (Loadstring-ready)
-- Key: "Xerox"
-- Features: draggable UI, nicer visuals, Fly GUI, Script Searcher, Zekrom, Speed Hub, Noclip toggle, ESP toggle

local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer

-- URLs (provided by user)
local FLY_URL       = "https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"
local SEARCHER_URL  = "https://raw.githubusercontent.com/madonchik123/USL/main/main.lua"
local ZEKROM_CODE   = 'loadstring(Game:HttpGet"https://raw.githubusercontent.com/ahmadsgamer2/Zekrom-Hub-X/main/Zekrom-Hub-X-exe")()'
local SPEED_CODE    = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", true))()'
local CORRECT_KEY   = "Xerox"

-- Safety: remove old GUI if present
pcall(function()
    local old = CoreGui:FindFirstChild("HacksHubUI_v2")
    if old then old:Destroy() end
end)

-- Helpers
local function make(class, props)
    local obj = Instance.new(class)
    if props then
        for k, v in pairs(props) do
            if k ~= "Parent" then obj[k] = v end
        end
    end
    if props and props.Parent then obj.Parent = props.Parent end
    return obj
end

local function makeButton(parent, text, pos)
    return make("TextButton", {
        Parent = parent,
        Size = UDim2.new(0, 200, 0, 44),
        Position = pos,
        BackgroundTransparency = 0,
        BackgroundColor3 = Color3.fromRGB(40,40,40),
        TextColor3 = Color3.new(1,1,1),
        Font = Enum.Font.Gotham,
        TextSize = 16,
        Text = text,
        AutoButtonColor = true
    })
end

local function setStatus(lbl, txt, dur)
    if not lbl or not lbl:IsDescendantOf(game) then return end
    lbl.Text = "Status: " .. tostring(txt or "Ready")
    if dur and dur > 0 then
        delay(dur, function()
            pcall(function() if lbl and lbl.Parent then lbl.Text = "Status: Ready" end end)
        end)
    end
end

-- Simple draggable utility (applies to a frame)
local function makeDraggable(frame, dragArea)
    dragArea = dragArea or frame
    local dragging, dragInput, dragStart, startPos
    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    dragArea.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    dragArea.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

-- Build ScreenGui
local screenGui = make("ScreenGui", {
    Name = "HacksHubUI_v2",
    ResetOnSpawn = false,
    Parent = CoreGui
})

-- Main window
local mainFrame = make("Frame", {
    Parent = screenGui,
    Size = UDim2.new(0, 520, 0, 320),
    Position = UDim2.new(0.5, -260, 0.5, -160),
    AnchorPoint = Vector2.new(0.5,0.5),
    BackgroundColor3 = Color3.fromRGB(20,20,20),
    BorderSizePixel = 0
})
make("UICorner", {Parent = mainFrame, CornerRadius = UDim.new(0, 12)})
make("UIStroke", {Parent = mainFrame, ApplyStrokeMode = Enum.ApplyStrokeMode.Border, Color = Color3.fromRGB(45,45,45), Thickness = 1})

-- Header
local header = make("Frame", {
    Parent = mainFrame,
    Size = UDim2.new(1, 0, 0, 44),
    Position = UDim2.new(0,0,0,0),
    BackgroundTransparency = 0,
    BackgroundColor3 = Color3.fromRGB(15,15,15)
})
make("UICorner", {Parent = header, CornerRadius = UDim.new(0, 12)})
local title = make("TextLabel", {
    Parent = header,
    Size = UDim2.new(1, -80, 1, 0),
    Position = UDim2.new(0, 12, 0, 0),
    BackgroundTransparency = 1,
    Text = "Hacks Hub v2",
    TextColor3 = Color3.new(1,1,1),
    Font = Enum.Font.GothamBold,
    TextSize = 18,
    TextXAlignment = Enum.TextXAlignment.Left
})
local closeBtn = make("TextButton", {
    Parent = header,
    Size = UDim2.new(0, 34, 0, 28),
    Position = UDim2.new(1, -44, 0.5, -14),
    BackgroundColor3 = Color3.fromRGB(165, 65, 65),
    Text = "X",
    Font = Enum.Font.GothamBold,
    TextSize = 16,
    TextColor3 = Color3.new(1,1,1)
})
make("UICorner", {Parent = closeBtn, CornerRadius = UDim.new(0, 6)})

closeBtn.MouseButton1Click:Connect(function()
    pcall(function() screenGui:Destroy() end)
end)

-- Key input panel (within mainFrame)
local keyPanel = make("Frame", {
    Parent = mainFrame,
    Size = UDim2.new(1, -28, 0, 120),
    Position = UDim2.new(0, 14, 0, 60),
    BackgroundColor3 = Color3.fromRGB(24,24,24)
})
make("UICorner", {Parent = keyPanel, CornerRadius = UDim.new(0,10)})
make("UIStroke", {Parent = keyPanel, Color = Color3.fromRGB(40,40,40), Thickness = 1})

local prompt = make("TextLabel", {
    Parent = keyPanel,
    Size = UDim2.new(1, -24, 0, 28),
    Position = UDim2.new(0, 12, 0, 10),
    BackgroundTransparency = 1,
    Text = "Enter Key to Unlock (case-sensitive):",
    TextColor3 = Color3.fromRGB(200,200,200),
    Font = Enum.Font.Gotham,
    TextSize = 14,
    TextXAlignment = Enum.TextXAlignment.Left
})

local keyBox = make("TextBox", {
    Parent = keyPanel,
    Size = UDim2.new(1, -140, 0, 36),
    Position = UDim2.new(0, 12, 0, 44),
    BackgroundColor3 = Color3.fromRGB(18,18,18),
    TextColor3 = Color3.new(1,1,1),
    Text = "",
    PlaceholderText = "Enter key here...",
    Font = Enum.Font.Gotham,
    TextSize = 16,
    ClearTextOnFocus = false
})
make("UICorner", {Parent = keyBox, CornerRadius = UDim.new(0,8)})
make("UIStroke", {Parent = keyBox, Color = Color3.fromRGB(35,35,35), Thickness = 1})

local submitBtn = make("TextButton", {
    Parent = keyPanel,
    Size = UDim2.new(0, 100, 0, 36),
    Position = UDim2.new(1, -116, 0, 44),
    BackgroundColor3 = Color3.fromRGB(45,120,220),
    TextColor3 = Color3.new(1,1,1),
    Text = "Unlock",
    Font = Enum.Font.GothamBold,
    TextSize = 14
})
make("UICorner", {Parent = submitBtn, CornerRadius = UDim.new(0,8)})

-- Status label
local statusLabel = make("TextLabel", {
    Parent = mainFrame,
    Size = UDim2.new(1, -28, 0, 20),
    Position = UDim2.new(0,14,1,-36),
    BackgroundTransparency = 1,
    Text = "Status: Ready",
    TextColor3 = Color3.fromRGB(200,200,200),
    Font = Enum.Font.Gotham,
    TextSize = 13,
    TextXAlignment = Enum.TextXAlignment.Left
})

-- Make header draggable (drags the whole mainFrame)
makeDraggable(mainFrame, header)

-- Hub area (created only after correct key)
local function createHub()
    -- clear keyPanel
    pcall(function() keyPanel:Destroy() end)

    local hubArea = make("Frame", {
        Parent = mainFrame,
        Size = UDim2.new(1, -28, 1, -120),
        Position = UDim2.new(0, 14, 0, 60),
        BackgroundTransparency = 1
    })

    -- Two columns of buttons
    local flyBtn = makeButton(hubArea, "Fly GUI", UDim2.new(0, 12, 0, 6))
    local searchBtn = makeButton(hubArea, "Script Searcher", UDim2.new(0, 12, 0, 62))
    local zekromBtn = makeButton(hubArea, "Zekrom Hub", UDim2.new(0, 12, 0, 118))
    local speedBtn = makeButton(hubArea, "Speed Hub", UDim2.new(0, 12, 0, 174))

    local noclipBtn = make("TextButton", {
        Parent = hubArea,
        Size = UDim2.new(0, 200, 0, 44),
        Position = UDim2.new(0, 268, 0, 6),
        BackgroundColor3 = Color3.fromRGB(60,60,60),
        TextColor3 = Color3.new(1,1,1),
        Font = Enum.Font.Gotham,
        TextSize = 16,
        Text = "Noclip: OFF"
    })
    make("UICorner", {Parent = noclipBtn, CornerRadius = UDim.new(0,8)})

    local espBtn = make("TextButton", {
        Parent = hubArea,
        Size = UDim2.new(0, 200, 0, 44),
        Position = UDim2.new(0, 268, 0, 62),
        BackgroundColor3 = Color3.fromRGB(60,60,60),
        TextColor3 = Color3.new(1,1,1),
        Font = Enum.Font.Gotham,
        TextSize = 16,
        Text = "ESP: OFF"
    })
    make("UICorner", {Parent = espBtn, CornerRadius = UDim.new(0,8)})

    local rejoinBtn = make("TextButton", {
        Parent = hubArea,
        Size = UDim2.new(0, 200, 0, 44),
        Position = UDim2.new(0, 268, 0, 118),
        BackgroundColor3 = Color3.fromRGB(60,60,60),
        TextColor3 = Color3.new(1,1,1),
        Font = Enum.Font.Gotham,
        TextSize = 16,
        Text = "Rejoin"
    })
    make("UICorner", {Parent = rejoinBtn, CornerRadius = UDim.new(0,8)})

    -- Make hub draggable independently
    makeDraggable(mainFrame, header)

    -- Implement actions
    flyBtn.MouseButton1Click:Connect(function()
        setStatus(statusLabel, "Downloading Fly GUI...", 0)
        spawn(function()
            local ok, body = pcall(function() return game:HttpGet(FLY_URL, true) end)
            if not ok or not body or body == "" then
                setStatus(statusLabel, "Failed to download Fly GUI.", 4)
                return
            end
            local ok2, err = pcall(function() loadstring(body)() end)
            if ok2 then
                setStatus(statusLabel, "Fly GUI loaded.", 4)
            else
                setStatus(statusLabel, "Error running Fly GUI: "..tostring(err), 6)
            end
        end)
    end)

    searchBtn.MouseButton1Click:Connect(function()
        setStatus(statusLabel, "Running Script Searcher...", 0)
        spawn(function()
            local ok, err = pcall(function() loadstring(game:HttpGet(SEARCHER_URL, true))() end)
            if ok then
                setStatus(statusLabel, "Script Searcher loaded.", 4)
            else
                setStatus(statusLabel, "Error loading Script Searcher.", 4)
            end
        end)
    end)

    zekromBtn.MouseButton1Click:Connect(function()
        setStatus(statusLabel, "Loading Zekrom Hub...", 0)
        spawn(function()
            local ok, err = pcall(function() loadstring(ZEKROM_CODE)() end)
            if ok then setStatus(statusLabel, "Zekrom loaded.", 4) else setStatus(statusLabel, "Zekrom error.", 4) end
        end)
    end)

    speedBtn.MouseButton1Click:Connect(function()
        setStatus(statusLabel, "Loading Speed Hub...", 0)
        spawn(function()
            local ok, err = pcall(function() loadstring(SPEED_CODE)() end)
            if ok then setStatus(statusLabel, "Speed Hub loaded.", 4) else setStatus(statusLabel, "Speed Hub error.", 4) end
        end)
    end)

    -- Simple Noclip toggle
    local noclipOn = false
    local noclipConnection
    noclipBtn.MouseButton1Click:Connect(function()
        noclipOn = not noclipOn
        noclipBtn.Text = "Noclip: " .. (noclipOn and "ON" or "OFF")
        if noclipOn then
            noclipConnection = RunService.Stepped:Connect(function()
                local char = LocalPlayer.Character
                if char and char:IsA("Model") then
                    for _, part in pairs(char:GetDescendants()) do
                        if part:IsA("BasePart") and part.CanCollide then
                            part.CanCollide = false
                        end
                    end
                end
            end)
            setStatus(statusLabel, "Noclip enabled.", 3)
        else
            if noclipConnection then noclipConnection:Disconnect() noclipConnection = nil end
            -- try restore collisions (best-effort)
            local char = LocalPlayer.Character
            if char and char:IsA("Model") then
                for _, part in pairs(char:GetDescendants()) do
                    if part:IsA("BasePart") then
                        pcall(function() part.CanCollide = true end)
                    end
                end
            end
            setStatus(statusLabel, "Noclip disabled.", 3)
        end
    end)

    -- Simple ESP toggle (Billboard name + box)
    local espOn = false
    local espTags = {}

    local function addESPToPlayer(plr)
        if not plr or not plr.Character then return end
        local char = plr.Character
        if espTags[plr] then return end

        local tag = {}
        -- name billboard
        local billboard = make("BillboardGui", {
            Parent = char:FindFirstChildWhichIsA("BasePart") or char:FindFirstChild("HumanoidRootPart") or char,
            Adornee = char:FindFirstChild("Head"),
            Size = UDim2.new(0, 120, 0, 30),
            AlwaysOnTop = true
        })
        local label = make("TextLabel", {
            Parent = billboard,
            Size = UDim2.new(1,0,1,0),
            BackgroundTransparency = 1,
            Text = plr.Name,
            TextColor3 = Color3.new(1,1,1),
            Font = Enum.Font.GothamBold,
            TextSize = 14
        })
        billboard.Parent = char

        tag.billboard = billboard
        espTags[plr] = tag
    end

    local function removeESPFromPlayer(plr)
        local tag = espTags[plr]
        if not tag then return end
        pcall(function()
            if tag.billboard and tag.billboard.Parent then tag.billboard:Destroy() end
        end)
        espTags[plr] = nil
    end

    espBtn.MouseButton1Click:Connect(function()
        espOn = not espOn
        espBtn.Text = "ESP: " .. (espOn and "ON" or "OFF")
        if espOn then
            for _, plr in pairs(Players:GetPlayers()) do
                if plr ~= LocalPlayer then addESPToPlayer(plr) end
            end
            setStatus(statusLabel, "ESP enabled.", 3)
        else
            for plr, _ in pairs(espTags) do removeESPFromPlayer(plr) end
            setStatus(statusLabel, "ESP disabled.", 3)
        end
    end)

    -- Keep ESP updated for new players / character respawns
    Players.PlayerAdded:Connect(function(plr)
        plr.CharacterAdded:Connect(function()
            if espOn and plr ~= LocalPlayer then addESPToPlayer(plr) end
        end)
    end)
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            plr.CharacterAdded:Connect(function()
                if espOn then addESPToPlayer(plr) end
            end)
        end
    end

    rejoinBtn.MouseButton1Click:Connect(function()
        setStatus(statusLabel, "Rejoining...", 0)
        spawn(function()
            pcall(function() game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer) end)
        end)
    end)
end

-- Submit behavior (check key)
submitBtn.MouseButton1Click:Connect(function()
    local entered = tostring(keyBox.Text or "")
    if entered == CORRECT_KEY then
        setStatus(statusLabel, "Key accepted. Opening hub...", 2)
        createHub()
    else
        keyBox.Text = ""
        keyBox.PlaceholderText = "❌ Incorrect key"
        setStatus(statusLabel, "Incorrect key.", 3)
    end
end)

keyBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then submitBtn:MouseButton1Click() end
end)

-- Note to user
setStatus(statusLabel, "Note: Requires exploit with HttpGet & loadstring.", 6)
